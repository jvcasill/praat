form Save intervals to small sound files
	comment Give the folder where to save the sound files:
	sentence Folder /Users/BMXican47/desktop/test
	comment Give an optional prefix for all filenames:
	sentence Prefix t
	comment Give an optional suffix for all filenames:
	sentence Suffix t
endform

soundname$ = selected$ ("TextGrid", 1)
select TextGrid 'soundname$'
numberOfIntervals = Get number of intervals... 1
intnumber = 100

for interval to numberOfIntervals
	select TextGrid 'soundname$'
	intname$ = Get label of interval... 1 interval
	check = 0
	if intname$ = "xxx"
		check = 1
	endif
	if check = 0
		intnumber = intnumber + 1
		intervalstart = Get starting point... 1 interval
		intervalend = Get end point... 1 interval
		select LongSound 'soundname$'
		Extract part... intervalstart intervalend yes
		intervalfile$ = "'prefix$'_" + "'intnumber'" + "_'suffix$'"
		Rename... 'intervalfile$'
		select TextGrid 'soundname$'
		select Sound 'intervalfile$'
		Write to binary file... 'folder$'/'intervalfile$'.Sound
		Remove
	endif
endfor

